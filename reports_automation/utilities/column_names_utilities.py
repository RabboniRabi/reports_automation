"""
Module with column name definitions
"""


# Column names are defined here so that they can be edited in one place

district_name = 'district_name'
district = 'District'
edu_district_name = 'edu_dist_name'
block_name = 'block_name'
block = 'Block'
udise_col = 'udise_code'
school_name ='school_name'
total_student_count = 'total'
total_students = 'total_students'
name = 'Name'
month_col = 'Month'
year_col = 'Year'
yes_col = 'Yes'
no_col = 'No'
web = 'Website'
mobile = 'Mobile'
all_management = 'All_Management'
management = 'management'
management_type = "management_type"
category_type ="category_type"
distinct_udise_count = 'count(DISTINCT udise_code)'
emis_id = 'emis_id'
gender = 'Gender'
school_category = 'category'
school_category_full_name = 'School_Category'
school_level = 'school_level'
class_number = 'class'
school_type = 'school_type'
un_aided = 'Un-aided'
central_govt = 'Central Govt'
cate_type = 'cate_type'
section = 'section'
tot_sections = 'Total Sections'

class_section = 'Class_Section'

class_id = 'class_id'
tot_schools = 'Total Schools'

student_name = 'student_name'
cwsn_students ='cwsn'
beo_rank = 'BEO Rank'
deo = 'DEO'
beo = 'BEO'
deo_rank_elm = 'DEO Rank Elementary'
deo_rank_sec = 'DEO Rank Secondary'
perc_students_cp = '% Students ageing > 30 days'
total_cwsn_students ='cwsn'
emis_number = 'EMIS_Number'



# Common pool specific column names
students_ageing30_count = 'last_30days'
total_cp_students ='total'
ageing = 'ageing'
perc_ageing = '% ageing in CP'
class_1 = '1'
class_2 = '2'
class_3 = '3'
class_4 = '4'
class_5 = '5'
class_6 = '6'
class_7 = '7'
class_8 = '8'
class_9 = '9'
class_10 = '10'
class_11 = '11'
class_12 = '12'


#CWSN Transition specific column names
cwsn_students_count_cls8_2022_23 = 'cwsn_students_count_cls8_2022_23'
cwsn_students_transitioned_cls9_2023_24 = 'cwsn_students_transitioned_cls9_2023_24'
cwsn_students_transitioned_cls8_9_perc = '% CWSN students transitioned from Class 8 to 9'

cwsn_students_count_cls5_2022_23 = 'cwsn_students_count_cls5_2022_23'
cwsn_students_transitioned_cls6_2023_24 = 'cwsn_students_transitioned_cls6_2023_24'
cwsn_students_transitioned_cls5_6_perc = '% CWSN students transitioned from Class 5 to 6'

cwsn_students_count_cls9_2022_23 = 'cwsn_students_count_cls9_2022_23'
cwsn_students_transitioned_cls10_2023_24 = 'cwsn_students_transitioned_cls10_2023_24'
cwsn_students_transitioned_cls9_10_perc = '% CWSN students transitioned from Class 9 to 10'

cwsn_students_count_cls10_2022_23 = 'cwsn_students_count_cls10_2022_23'
cwsn_students_transitioned_cls11_2023_24 = 'cwsn_students_transitioned_cls11_2023_24'
cwsn_students_transitioned_cls10_11_perc = '% CWSN students transitioned from Class 10 to 11'

cwsn_students_count_cls11_2022_23 = 'cwsn_students_count_cls11_2022_23'
cwsn_students_transitioned_cls12_2023_24 = 'cwsn_students_transitioned_cls12_2023_24'
cwsn_students_transitioned_cls11_12_perc = '% CWSN students transitioned from Class 11 to 12'

#Student Transition specific column names
tc_cls8_total_2022_23 = 'tc_cls8_total_2022_23'
tc_cls8_issued_2023_24 = 'tc_cls8_issued_2023_24'
tc_cls8_issued_2023_24_perc = '% students issued TC in Class 8'

tc_cls5_total_2022_23 = 'tc_cls5_total_2022_23'
tc_cls5_issued_2023_24 = 'tc_cls5_issued_2023_24'
tc_cls5_issued_2023_24_perc = '% students issued TC in Class 5'


tc_cls10_total_2022_23 = 'tc_cls10_total_2022_23'
tc_cls10_issued_2023_24 = 'tc_cls10_issued_2023_24'
tc_cls10_issued_2023_24_perc = '% students issued TC in Class 10'


#TC Issued Specific Reports
students_count_cls8_2022_23 = 'students_count_cls8_2022_23'
students_transitioned_cls9_2023_24 = 'students_transitioned_cls9_2023_24'
students_transitioned_cls8_9_perc = '% students transitioned from Class 8 to 9'


students_count_cls5_2022_23 = 'students_count_cls5_2022_23'
students_transitioned_cls6_2023_24 = 'students_transitioned_cls6_2023_24'
students_transitioned_cls5_6_perc = '% students transitioned from Class 5 to 6'


students_count_cls10_2022_23 = 'students_count_cls10_2022_23'
students_transitioned_cls11_2023_24 = 'students_transitioned_cls11_2023_24'
students_transitioned_cls10_11_perc = '% students transitioned from Class 10 to 11'

#Enrollment Specific Reports

students_enrolled_cls1_2022_23 = 'students_enrolled_cls1_2022_23'
students_enrolled_cls1_2023_24 = 'students_enrolled_cls1_2023_24'
students_enrolled_cls1_change_perc = '% students_enrolled_cls1_change_perc'
sch_with_no_students = "Schools with no students"

#Promotion Report
Total_Students = 'Total_Students'
Students_Promoted_Count = 'Students_Promoted_Count'
Students_Not_Promoted_Count = 'Students_Not_Promoted_Count'
Students_Pendingtobe_Promoted_perc = '% SStudents Pending to be Promoted'


# Health report specific column names
total = 'Total'
screened = 'Screened'
fully_comp = 'Fully Completed'
part_comp = 'Partially Completed'
not_started = 'Not started'
perc_screened = '% Screened'
perc_comp = '% Fully completed'


# CWSN report specific column names
cwsn_tot = 'Total CWSN Students'
cwsn_name = 'Name'
cwsn_in_School = 'In_School'
stdnts_in_school = 'Students in School'
cwsn_cp = 'Common Pool'
stdnts_in_cp = 'Students in Common Pool'
cwsn_schl_name = 'SchoolName'
cwsn_has_acct = 'HavingAccount'
cwsn_status = 'Student_Status'
nid = 'NID'
nid_count = 'NID Count'
udid = 'UDID'
udid_count = 'Issued UDID Count'
with_acct = 'Number of students with account'
witht_acct = 'Number of students without account'
perc_students_with_UDID = '% Students with UDID'
perc_students_with_NID = '% Students with NID'
perc_students_with_acct = '% Students with account'
stu_emis_no = 'Student_EMIS_NO'
cwsn_school_ie = 'School + IE'
cwsn_stu_school_ie = 'Students at School + IE'
cwsn_home_ie = 'Home Based + IE'
cwsn_school = "School"
cwsn_home_based = 'Home Based'
cwsn_home_based_stu = 'Home Based Students'
cwsn_stu_home_ie = 'Home Based + IE Students'
cwsn_school_stu = "Students at School"
pending_web_applications = 'Pending website applications'
pending_mob_applications = 'Pending mobile applications'


# TPD report specific column names
tot_teachers = 'Total_Teachers'
train_attnd = 'Traning_Attended'

# PET to school mapping specific column names
mapping_status = 'Mapping Status'
fully_mapped = 'Fully Mapped School'
part_mapped = 'Partially Mapped School'
perc_fully_mapped = '% Fully mapped'


# Ennum Ezhuthum related column names
perc_asses_comp = '% Summative Assessment Completion'


# Kalai thiruvizha specific column
participants = 'Participations'
tot_students = 'Total Students'
per_participants = '% Student participations'

# Palli Parvai specific column names
observation_date = 'Date of Observation'
observed_by = 'Observed by'
designation_user_id = 'Observed by'
pp_designation = 'stackholders'
deo_target = 'deo_target'
ceo_target ='ceo_target'
perc_DEO_obs = '% School Observations by DEOs'
perc_CEO_obs = '% School Observations by CEOs'
perc_obs_comp = '% Overall Observation Completion'

# BRC-CRC mapping specific column names
beo_user = 'beo_user'
beo_name ='beo_name'
deo_name_elm = 'deo_name (elementary)'
deo_name_sec = 'deo_name (secondary)'
school_level = 'school_level'

#For Output view
deo_name_elementary = 'DEO Name (Elementary)'
deo_name_secondary = 'DEO Name (Secondary)'
block_name_output = 'Block Name'

# Report specific column names
elem_schl_lvl = 'Elementary School'
scnd_schl_lvl = 'Secondary School'


# OoSC report specific column names
reason_type = 'Reason_type'
to_be_surveyed = 'To be surveyed'
perc_to_be_admitted = '% to be admitted'
perc_admitted_oosc = '% Students Admitted' 
to_be_admitted = 'To be admitted'
oosc_student_status = 'student_status'
not_admttd = 'Not Admitted'
to_be_verified = 'To be verified'
non_target = 'Non-Target'
stdnt_admttd = 'Student Admitted'
stdnts_admttd = 'Students Admitted'
oosc_stu_admt_othr_reasons = 'Students admitted - Other reasons'
oosc_stu_nt_admt_othr_reasons = 'Students Not admitted - Other reasons'
oosc_tot_surveyed = 'Total Surveyed'
non_target_not_admitted = 'Not Admitted from Non Target'
non_target_admitted = 'Admitted from Non Target'
verified_not_admitted = 'Not Admitted from To be Verified'
verified_admitted = 'Admitted from To be Verified'
admitted_not_admitted = 'Not Admitted from To be Admitted'
admitted = 'Admitted from To be Admitted'
oosc_stu_id = 'student_id'
oosc_no_stu_absent_greater_6 = 'Number of students absent for greater than 6 days'
oosc_pot_dropout_count = 'Total Potential Dropouts'
oosc_perc_pot_dropouts = '% of Potential Dropouts'

# Hi-tech lab report specific column names
up_time_hrs = 'up_time_hrs'
mediam_up_time_hrs = 'Median Uptime Hours'

# Library specific column names
tot_secs = 'Total_Sections'
total_tchrs = 'Total Teachers'
tchrs_assigning_books = 'Teachers assigning books'
sctns_assigning_books = 'Sections assigning books'
tchrs_not_assigning_books = 'Teachers not assigning books'
sctns_not_assigning_books = 'Sections not assigning books'
perc_tchrs_assigning_books = '% Teachers assigning books'
perc_sctns_assigning_books = '% Sections assigning books'
shelves_created = 'No_of_Section_created_shelves'
shelves_not_created = 'No_of_Section_Not_created_shelves'
perc_shelves_created = '% Shelves created'
class_teacher_id = 'class_teacher_id'
book_assigning_status = 'Book_Assigning_Status'
books_not_assigned = 'Books Not Assigned'
books_assigned = 'Books Assigned'


# Attendance specific column names
tot_tchrs = 'Total_teachers'
updt_tchrs = 'Updated_Teachers'
appld_tchrs = 'Applied_Teachers'
perc_tchrs_updated = '% Teachers Updated'
per_tchrs_applied = '% Teachers Applied'
tot_marked_schls = 'Total Marked Schools'
marked_schools = 'Marked Schools'
unmarked_schools = 'Unmarked Schools'
tot_unmarked_schls = 'Total Unmarked Schools'
perc_marked_schls = '% Marked'
tot_marked = 'totalmarked'
tot_unmarked = 'totalunmarked'
perc_7_days_unmarked_schls = '% Unmarked Schools for 7 days'
no_of_days_abs = 'no_of_days_absent'
att_class_id = 'class_id'
att_total_students = 'total_students'
att_perc_students_abs_6_days = '% Students absent for greater than 6 days'


# Updation specific column names
up_tot_tchrs = 'total_teachers'
not_updt_tchrs = 'notupdated_teachers'
perc_not_updt = '% Not Updated'

# Ranking specific column names
desig = 'Designation'
metric_code = 'metric_code'
metric_category = 'metric_category'
rank_col = 'Rank'
ranking_value = 'Ranking Value'
ranking_value_desc = 'Ranking Value Description'
beo_rank = 'BEO Rank'
deo_elem_rank = 'DEO (Elementary) Rank'
deo_sec_rank = 'DEO (Secondary) Rank'

# Sports specific column names
test_comp_status = 'Completion Status'
test_in_progress = 'In Progress'
test_completed = 'Completed'
test_not_started = 'Not Yet Started'
sports_tot_stu = 'total_students'
m50_comp_stu = '50m Completed_Students'
m600_800_comp_stu = '600/800m Completed_Students'
shuttle_comp_stu = '6*10m shuttle Completed_Students'
kg4_shot_comp_stu = '4kg shotput Completed_Students'
long_jump_comp_stu = 'Longjump Completed_Students'
perc_test_comp = '% Completed'
perc_50m_comp = '% 50M completed'
perc_600m_800m_comp = '% 600/800M completed'
perc_6_10m_shutt_comp = '% 6*10M shuttle completed'
perc_4kg_shot_comp = '% 4kg shotput completed'
perc_long_jump_comp = '% long jump completed'
perc_avg_overall_comp = 'Average % of tests completed'
delivery_status = 'Delivery_Status'
fully_delivered = 'Fully Delivered'
part_delivered = 'Partially Delivered'
not_deliverd = 'Not Deliverd'
not_delivered = 'Not Delivered'
perc_equip_delivered = '% (Fully + Partially Delivered)'

# G2C pending applications
tot_app_rcvd = 'Total_applications_received'
tot_aprvd = 'Total_Approved'
tot_pnding = 'Total_Pending'
tot_rjctd = 'Total_Rejected'
tot_pnd_grtr_15_days = 'Pending_more_than_15days'
tot_pnd_lessr_15_days = 'Pending_less_than_15days'
perc_apps_grtr_15_days = '% Pending_more_than_15days'


# Welfare schemes specific columns
scheme_status = 'status'
scheme_inprogress = 'inprogress'
scheme_inprogress_upper_case = 'Inprogress'
scheme_in_progress = 'In progress'
scheme_comp = 'completed'
scheme_completed = 'Completed'
scheme_nt_strt = 'not started'
scheme_not_started = 'Not started'
perc_schools_issued_books = '% schools completed book issue'
perc_schools_issued_uniforms = '% schools completed uniforms issue'
perc_schools_issued_notebooks = '% schools completed notebooks issue'
perc_schools_issued_geo_boxes = '% schools completed geometry boxes issue'
perc_schools_issued_crayons = '% schools completed crayons issue'
perc_schools_issued_colour_pencil = '% schools completed colour pencil issue'
perc_schools_issued_bag = '% schools completed bag issue'
perc_schools_issued_atlas = '% schools completed atlas issue'
perc_schools_issued_cycle = '% schools completed cycle issue'
perc_schools_issued_laptop = '% schools completed laptop issue'
schemes_total_students_small_case = 'total_students'
schemes_total_students = 'Total_Students'
schemes_issued_students = 'issued_students'

#Student teacher ratio specific column
student_teacher_ratio = 'student_teacher_ratio'
avg_stu_tch_ratio = 'Average Student Teacher Ratio'

# Teacher data specific columns
class_taught = 'Class_Taught'
upper_primary_only = 'Upper primary only'
upper_primary_and_secondary = 'Upper primary and Secondary'
teacher_id = 'Teacher_ID'
not_assigned = 'Not Assigned'
sections_without_teacher = 'Total number of sections without class teacher'

# subjects data sepecific columns
english = 'English'
maths = 'Mathematics'
tamil = 'Tamil'

# Attendance specific columns
attendance = "Attendance"
total_invited = "Total Invited"
present = "Present"
absent = "Absent"
absent_replaced = "Absent & Replaced"
not_filled = 'Not Filled'
perc_present = "% HM's Present"
att_sch_markd_perc = 'percentage_marked'
att_sch_markd_tch_perc = 'percentage_marked'
att_avg_sch_markd_perc = 'Average % of schools marking attendance'
att_avg_sch_tch_markd_perc = 'Average % of schools marking teachers attendance'
att_stu_avg_present_perc = 'average_present_perc'
att_stu_avg_absent_perc = 'average_absent_perc'
att_stu_avg_present_frmt = 'Average students present %'
att_stu_avg_absent_frmt = 'Average students absent %'
att_sec_working_tot = 'total_sections_working_between_dates'
att_sec_marked_tot = 'total_sections_marked_between_dates'
att_sec_mark_perc = '% sections marking attendance'
att_tch_avg_present_perc = 'average_present_perc'
att_tch_avg_absent_perc = 'average_absent_perc'
att_tch_avg_present_frmt = 'Average teachers present %'
att_tch_avg_absent_frmt = 'Average teachers absent %'

# Career Guidance specific columns
cg_ex_res_stat = 'Exam_Result_Status'
cg_ex_res_pass = 'pass'
cg_stu_appld = 'student_applied'
cg_clg_nm = 'college_name'
cg_stu_cert = 'student_certificate'
cg_stu_appld_wo_clg_name_dbt = 'Applied without College Name - doubtful reason'
cg_stu_not_appld = 'Not Applied to College'
cg_stu_not_updtd = 'Not Updated'
cg_stu_tgt = 'Target Student'
cg_stu_emis_no = 'EMIS_No'
cg_stu_not_appld_reason = 'reason_notapply'
cg_stu_supp_req = 'support'
cg_couns_supp_need = 'Counselling Support Needed'
cg_admin_supp_need = 'Administrative Support Needed'
cg_ecnom_supp_need = 'Economic Support Needed'
cg_perc_stu_w_clg_name = '% students with college name'



# board exams report specific columns
stu_name = 'NAME'
brd_tot_stu_appr = 'No. of students who appeared for all subjects'
brd_tot_stu_pass = 'No. of students passed'
brd_pass_perc = 'Pass %'
brd_pass_perc_med = 'Median Pass %'
brd_avg_marks = 'Average marks'
brd_marks_30_to_60_count = 'Students who secured marks between 35% to 60%'
brd_marks_60_to_80_count = 'Students who secured marks between 60% to 80%'
brd_marks_grtr_80_count = 'Students who secured marks > 80%'
brd_cents = 'No. of Centums'
brd_maj_grp_cents = 'Major group Students who secured centum in one or more subjects'
brd_voc_grp_cents = 'Vocational group Students who secured centum in one or more subjects'
brd_tot_stu_w_cents = 'No. of students with centums'
brd_perc_stu_pass = '% students who have passed'
average_marks = "average_marks"
rank_state = 'Rank in State'
lang_rank_state = 'Language Rank in State'
eng_rank_state = 'English Rank in State'
math_rank_state = 'Mathematics Rank in State'
science_rank_state = 'Science Rank in State'
social_rank_state = 'Social Rank in State'
rank_dist = 'Rank in District'
lang_rank_dist = 'Language Rank in District'
eng_rank_dist = 'English Rank in District'
math_rank_dist = 'Mathematics Rank in District'
science_rank_dist = 'Science Rank in District'
social_rank_dist = 'Social Rank in District'
curr_school_performance = "Overall School Performance"
prev_school_performance = 'Previous Year Overall School Performance'
group_code = 'group_code'
mark_3 = 'BMARK3'
mark_4 = 'BMARK4'
mark_5 = 'BMARK5'
mark_6 = 'BMARK6'
tot_stu = 'EMIS_NO'
stu_pass = 'Pass'
pass_perc = 'Pass %'
tot_marks = 'total'
lang_marks = 'language'
eng_marks = 'english'
math_marks = 'maths'
science_theory = 'science_theo'
science_prac = 'science_prac'
science_marks = 'science'
social_marks = 'social'
curr_tot_stu = "EMIS_NO_count_curr_yr"
curr_pass = 'Pass_sum_curr_yr'
curr_pass_perc = 'Pass %_curr_yr'
curr_tot_marks = "total_median_curr_yr"
curr_avg_marks = "avg_median_curr_yr"
curr_lang_marks = "language_median_curr_yr"
curr_eng_marks = "english_median_curr_yr"
curr_math_marks = "maths_median_curr_yr"
curr_science_marks = "science_median_curr_yr"
curr_social_marks = "social_median_curr_yr"
prev_tot_stu = "EMIS_NO_count_prv_yr"
prev_pass = 'Pass_sum_prv_yr'
prev_pass_perc = 'Pass %_prv_yr'
prev_tot_marks = "total_median_prv_yr"
prev_avg_marks = "avg_median_prv_yr"
prev_lang_marks = "language_median_prv_yr"
prev_eng_marks = "english_median_prv_yr"
prev_math_marks = "maths_median_prv_yr"
prev_science_marks = "science_median_prv_yr"
prev_social_marks = "social_median_prv_yr"
brd_pass_perc_cmp_lst_yr = 'Pass % compared to last year'
brd_avg_cmp_lst_yr = 'Student Average marks compared to last year'
brd_lang_cmp_lst_yr = 'Language marks compared to last year'
brd_eng_cmp_lst_yr = 'English marks compared to last year'
brd_math_cmp_lst_yr = 'Mathematics marks compared to last year'
brd_social_cmp_lst_yr = 'Social marks compared to last year'
brd_science_cmp_lst_yr = 'Science marks compared to last year'
brd_med_avg_mrks = 'Median of student Average marks'
brd_med_lang_mrks = "Median Language mark"
brd_med_eng_mrks = "Median English mark"
brd_med_math_mrks = "Median Mathematics mark"
brd_med_science_mrks = "Median Science mark"
brd_med_social_mrks = "Median Social mark"

# consolidated ranking specific column names
cons_tot_wt_scr = 'Total Weighted Score'
cons_curr_wt_scr = 'Current month weighted Score'
cons_impr_wt_scr = 'Improvement weighted Score'
cons_ovr_wt_scr = 'Overall Weighted Score'

def get_value(var_name: str):
    """
    Function to get the value mapped to the variable defined in this file.
    This resolution of variable name to value is necessary as variables
    defined in JSON dont automatically get resolved to the value assigned to it
    when read in Python.

    If the value doesnt exist, the given variable name is returned as is.
    
    Parameters:
    ----------
    var_name: str
        The name of the variable to look up the value for
    Returns:
        The value mapped to the variable    
    """

    # Remove module part of variable name if it exists
    module_import_name = 'cols.'
    if (module_import_name in var_name):
        var_name = var_name.removeprefix(module_import_name)
    
    # Get the value mapped to the variable
    try:
        value = globals()[var_name]
        return value
    except KeyError:
        return var_name

def get_values(var_names_list: list):
    """
    Function to get the values for string list of variable names.

    This function is usef to fetch the values when the 
    variable names get converted to strings (When reading from JSON)

    Parameters:
    ----------
    var_names_arr: list
        List of variable names of strings whose values need to be fetched
    Returns:
    --------
        List of values corresponding to given list of string variable names
    """
    values = []
    for var_name in var_names_list:
        value = get_value(var_name)
        values.append(value)
    return values


def update_dictionary_var_strs(var_names_keys_dict: dict):
    """
    Function to update the keys in a given dictionary.
    The keys are strings of variable names and will be updated
    by mapping to the value assigned to the variable names.

    Parameters:
    -----------
    var_names_keys_dict: dict
        Dictionary whose keys (which are strings of variables) need to be updated with
        the values of the variable names
    
    Returns:
    -------
    The updated dictionary
    """

    updated_dict = {}

    for key in var_names_keys_dict.keys():
        dict_key_value = var_names_keys_dict[key]
        updated_key = get_value(key)

        # Set the updated key-value pair
        updated_dict[updated_key] = dict_key_value

    return updated_dict


def update_dictionary(var_names_dict: dict):
    """
    Function to update the keys & values in a given dictionary.
    If the keys and values are strings of variable names, they will be updated
    by mapping to the value assigned to the variable names.

    Parameters:
    -----------
    var_names_dict: dict
        Dictionary whose keys and values contain variables declared in this script and need to be updated with
        the values of the variable names
    
    Returns:
    -------
    The updated dictionary
    """

    updated_dict = {}

    col_utility_prefix = 'cols.'
    
    for key in var_names_dict.keys():
        if col_utility_prefix in key:
            dict_key_value = var_names_dict[key]
            updated_key = get_value(key)

            if col_utility_prefix in dict_key_value:
                if type(dict_key_value) is str:
                    updated_value = get_value(dict_key_value)
                    updated_dict[updated_key] = updated_value
                elif type(dict_key_value) is list:
                    updated_value = get_values(dict_key_value)
                    updated_dict[updated_key] = updated_value
            # Set the updated key-value pair
            else:
                updated_dict[updated_key] = dict_key_value
        # else if value is a string containing 'cols.' prefix, update the value
        elif type(var_names_dict[key]) is str and col_utility_prefix in var_names_dict[key]:
            updated_value = get_value(var_names_dict[key])
            updated_dict[key] = updated_value
        # else if value is a list with elements containing 'cols.' prefix, update the values
        elif type(var_names_dict[key]) is list and len(var_names_dict[key]) > 0 \
                and col_utility_prefix in var_names_dict[key][0]:
            updated_value = get_values(var_names_dict[key])
            updated_dict[key] = updated_value
        else:
            # Nothing to update
            updated_dict[key] = var_names_dict[key]

    return updated_dict



def update_nested_dictionaries(var_names_dict: dict):
    """
    Function to update the keys & values in a given dictionary and it's nested dictionaries.
    If the keys and values are strings of variable names, they will be updated
    by mapping to the value assigned to the variable names.

    Parameters:
    -----------
    var_names_dict: dict
        Dictionary whose keys and values contain variables declared in this script and need to be updated with
        the values of the variable names

    Returns:
    -------
    The updated dictionary
    """

    # First update the dictionary
    fully_updated_dict = update_dictionary(var_names_dict)

    # Then check for nested dictionaries and recursively call this function
    # to update the dictionaries

    for key in fully_updated_dict:
        if type(fully_updated_dict[key]) is dict:
            # Recursively call update_nested_dictionaries
            fully_updated_dict[key] = update_nested_dictionaries(fully_updated_dict[key])
        # If there is a list of dictionaries
        elif type(fully_updated_dict[key]) is list:
            for i in range(0,len(fully_updated_dict[key])):
                if type(fully_updated_dict[key][i]) is dict:
                    # update each dictionary
                    fully_updated_dict[key][i] = update_nested_dictionaries(fully_updated_dict[key][i])
        else:
            fully_updated_dict = update_dictionary(fully_updated_dict)

    return fully_updated_dict
